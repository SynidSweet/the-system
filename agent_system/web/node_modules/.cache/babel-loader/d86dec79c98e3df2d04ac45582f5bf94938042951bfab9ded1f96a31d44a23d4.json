{"ast":null,"code":"import _objectSpread from\"/code/personal/the-system/agent_system/web/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useCallback}from'react';import'./AgentBrowser.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function AgentBrowser(_ref){let{apiBaseUrl}=_ref;const[agents,setAgents]=useState([]);const[selectedAgent,setSelectedAgent]=useState(null);const[editMode,setEditMode]=useState(false);const[editedAgent,setEditedAgent]=useState(null);const[loading,setLoading]=useState(true);const[saving,setSaving]=useState(false);const[error,setError]=useState(null);const fetchAgents=useCallback(async()=>{try{const response=await fetch(\"\".concat(apiBaseUrl,\"/agents\"));const data=await response.json();setAgents(data.agents);setLoading(false);}catch(err){setError('Failed to load agents');setLoading(false);}},[apiBaseUrl]);useEffect(()=>{fetchAgents();},[fetchAgents]);const selectAgent=useCallback(async agent=>{try{const response=await fetch(\"\".concat(apiBaseUrl,\"/agents/\").concat(agent.name));const data=await response.json();setSelectedAgent(data);setEditedAgent(data);setEditMode(false);}catch(err){setError('Failed to load agent details');}},[apiBaseUrl]);const handleEdit=useCallback(()=>{setEditMode(true);},[]);const handleCancel=useCallback(()=>{setEditMode(false);setEditedAgent(selectedAgent);},[selectedAgent]);const handleSave=useCallback(async()=>{if(!selectedAgent||!editedAgent)return;setSaving(true);try{const response=await fetch(\"\".concat(apiBaseUrl,\"/agents/\").concat(selectedAgent.name),{method:'PUT',headers:{'Content-Type':'application/json'},body:JSON.stringify({instruction:editedAgent.instruction,available_tools:editedAgent.available_tools,context_documents:editedAgent.context_documents,model_config:editedAgent.model_config,permissions:editedAgent.permissions})});if(response.ok){setSelectedAgent(editedAgent);setEditMode(false);fetchAgents();// Refresh the list\n}else{throw new Error('Failed to save');}}catch(err){setError('Failed to save agent');}finally{setSaving(false);}},[apiBaseUrl,selectedAgent,editedAgent,fetchAgents]);const handleFieldChange=useCallback((field,value)=>{setEditedAgent(prev=>prev?_objectSpread(_objectSpread({},prev),{},{[field]:value}):null);},[]);const handleArrayFieldChange=useCallback((field,value)=>{try{const arrayValue=JSON.parse(value);if(Array.isArray(arrayValue)){setEditedAgent(prev=>prev?_objectSpread(_objectSpread({},prev),{},{[field]:arrayValue}):null);}}catch(e){// Invalid JSON, ignore\n}},[]);const handleObjectFieldChange=useCallback((field,value)=>{try{const objectValue=JSON.parse(value);if(typeof objectValue==='object'){setEditedAgent(prev=>prev?_objectSpread(_objectSpread({},prev),{},{[field]:objectValue}):null);}}catch(e){// Invalid JSON, ignore\n}},[]);if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"agent-browser loading\",children:\"Loading agents...\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"agent-browser\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"agent-list\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Agents\"}),/*#__PURE__*/_jsx(\"div\",{className:\"agent-items\",children:agents.map(agent=>/*#__PURE__*/_jsxs(\"div\",{className:\"agent-item \".concat((selectedAgent===null||selectedAgent===void 0?void 0:selectedAgent.id)===agent.id?'selected':''),onClick:()=>selectAgent(agent),children:[/*#__PURE__*/_jsx(\"div\",{className:\"agent-name\",children:agent.name}),/*#__PURE__*/_jsx(\"div\",{className:\"agent-status\",children:agent.status})]},agent.id))})]}),/*#__PURE__*/_jsx(\"div\",{className:\"agent-details\",children:selectedAgent?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"agent-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:selectedAgent.name}),/*#__PURE__*/_jsx(\"div\",{className:\"agent-actions\",children:!editMode?/*#__PURE__*/_jsx(\"button\",{onClick:handleEdit,className:\"edit-button\",children:\"Edit\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSave,className:\"save-button\",disabled:saving,children:saving?'Saving...':'Save'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleCancel,className:\"cancel-button\",disabled:saving,children:\"Cancel\"})]})})]}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"div\",{className:\"agent-fields\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Instruction\"}),editMode?/*#__PURE__*/_jsx(\"textarea\",{value:(editedAgent===null||editedAgent===void 0?void 0:editedAgent.instruction)||'',onChange:e=>handleFieldChange('instruction',e.target.value),className:\"instruction-input\",rows:10}):/*#__PURE__*/_jsx(\"div\",{className:\"instruction-display\",children:selectedAgent.instruction})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Available Tools\"}),editMode?/*#__PURE__*/_jsx(\"textarea\",{value:JSON.stringify((editedAgent===null||editedAgent===void 0?void 0:editedAgent.available_tools)||[],null,2),onChange:e=>handleArrayFieldChange('available_tools',e.target.value),className:\"json-input\",rows:5}):/*#__PURE__*/_jsx(\"div\",{className:\"tools-list\",children:selectedAgent.available_tools.map((tool,idx)=>/*#__PURE__*/_jsx(\"span\",{className:\"tool-chip\",children:tool},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Context Documents\"}),editMode?/*#__PURE__*/_jsx(\"textarea\",{value:JSON.stringify((editedAgent===null||editedAgent===void 0?void 0:editedAgent.context_documents)||[],null,2),onChange:e=>handleArrayFieldChange('context_documents',e.target.value),className:\"json-input\",rows:5}):/*#__PURE__*/_jsx(\"div\",{className:\"docs-list\",children:selectedAgent.context_documents.map((doc,idx)=>/*#__PURE__*/_jsx(\"span\",{className:\"doc-chip\",children:doc},idx))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Model Configuration\"}),editMode?/*#__PURE__*/_jsx(\"textarea\",{value:JSON.stringify((editedAgent===null||editedAgent===void 0?void 0:editedAgent.model_config)||{},null,2),onChange:e=>handleObjectFieldChange('model_config',e.target.value),className:\"json-input\",rows:4}):/*#__PURE__*/_jsx(\"pre\",{className:\"json-display\",children:JSON.stringify(selectedAgent.model_config,null,2)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Permissions\"}),editMode?/*#__PURE__*/_jsx(\"textarea\",{value:JSON.stringify((editedAgent===null||editedAgent===void 0?void 0:editedAgent.permissions)||{},null,2),onChange:e=>handleObjectFieldChange('permissions',e.target.value),className:\"json-input\",rows:4}):/*#__PURE__*/_jsx(\"pre\",{className:\"json-display\",children:JSON.stringify(selectedAgent.permissions,null,2)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"field-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Metadata\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"metadata\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"ID: \",selectedAgent.id]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Version: \",selectedAgent.version]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Status: \",selectedAgent.status]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Created: \",new Date(selectedAgent.created_at).toLocaleString()]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Updated: \",new Date(selectedAgent.updated_at).toLocaleString()]})]})]})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"no-selection\",children:\"Select an agent to view details\"})})]});}export default AgentBrowser;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}